{% extends "base.html" %}

{% block title %}MyTravelBook{% endblock %}

{% block content %}
<ul class="tabs">
    <li><a href="{% url 'travel_detail' travel_record.id %}" class="active">旅行概要</a></li>
   
    {% for category in categories %}
        <li>
            <a href="{% url 'category_detail' travel_record.id category.id %}">{{ category.category_name }}</a>
        </li>
    {% endfor %}

    {% if categories.count < 7 %}
    <li><a href="{% url 'add_category' travel_record.id %}">＋</a></li>
    {% endif %}

    <li><a href="{% url 'travelmemo_list' travel_record.id %}">たびメモ</a></li>
</ul>
    <div id="memo-list">
        {% for memo in memos %}
            <div class="memo">
                <p>{{ memo.memo_text }}</p>
                <p>投稿日時: {{ memo.created_at }}</p>
                
                {% if memo.memo_photo_path %}
                    <img src="{{ memo.memo_photo_path.url }}" alt="メモの画像" style="max-width: 300px;">
                {% endif %}

                <form action="{% url 'delete_memo' memo.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" onclick="return confirm('本当に削除しますか？')">削除</button>
                </form>
             </div>
        {% endfor %}
    </div>

    <div id="memo-form">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}

            <!--音声入力ボタン -->
            <button id="btn">音声入力</button>
            <div id="content"></div>

            <script>
                const speech = new webkitSpeechRecognition()
                speech.lang = 'ja-JP';

                const btn = document.getElementById('btn');
                const content = document.getElementById('content');

                btn.addEventListener('click', function(){
                    //音声認識をスタート
                    speech.start(); 
                });

                speech.addEventListener('result' , function(e){
                    console.log(e); 
                })

            </script>

            <button type="submit">送信</button>
        </form>
    </div>
{% endblock %}