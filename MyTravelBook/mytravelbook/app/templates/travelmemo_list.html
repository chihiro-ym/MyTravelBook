{% extends "base.html" %}

{% load static %}

{% block title %}MyTravelBook{% endblock %}

{% block content %}
{% include 'base_breadcrumb.html' %} <!-- パンくずリスト -->

{% include "base_tabs.html" with active_tab="travelmemo" %} <!-- タブ -->

<div id="memo-list">
    {% for memo in memos %}
        <div class="memo">
            <p>{{ memo.memo_text }}</p>
            <p>投稿日時: {{ memo.created_at }}</p>
            
            {% if memo.memo_photo_path %}
                <img src="{{ memo.memo_photo_path.url }}" alt="メモの画像" style="max-width: 300px;">
            {% endif %}

            <form action="{% url 'delete_memo' memo.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" onclick="return confirm('本当に削除しますか？')">削除</button>
            </form>
         </div>
    {% endfor %}
</div>

<div id="memo-form">
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}

        <!-- 音声入力ボタン -->
        <button type="button" id="btn">音声入力</button>
        <div id="content"></div>

        <!-- `memo_text`フィールドを`textarea`に変更 -->
        <textarea id="memo_text" name="memo_text" placeholder="ここにメモを入力してください"></textarea>

        <!-- 音声録音のボタン -->
        <button type="button" id="record-btn">録音開始</button>
        <button type="button" id="stop-btn" disabled>録音停止</button>
        <audio id="audio-playback" controls></audio>    

        <input type="hidden" name="audio_data" id="audio-data">
        <button type="submit" id="submit-btn" disabled>送信</button>
    </form>
</div>

<!-- 外部JavaScriptファイルの読み込み -->
<script src="{% static 'js/speechRecognition.js' %}"></script>
<script src="{% static 'js/audioRecorder.js' %}"></script>
{% endblock %}

